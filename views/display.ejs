<script>

    function deleteBlob(blobId) {
        $("#DeleteConfirmationDialog" + blobId).dialog(
            {
                resizable: false, height: 250, width: 300, modal: true,
                buttons: {
                    'OK': function () {
                        document.forms['deleteBlobForm' + blobId].submit();
                    },
                    'Cancel': function () {
                        $(this).dialog("close");
                    }
                }
            }
        );
    }


    function submitForm() {

        if ($('#upload input[type=file]').get(0).files.length >= 1) {
            $("#myProgress").append('<div id="progress-bar" class="progress-bar progress-bar-striped active " role="progressbar"></div>');
            //<div id="myBar"></div>
            //<div id="progress-bar" class="progress-bar progress-bar-striped active " role="progressbar"></div>
            move();

            document.forms['upload'].submit();


//        <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width:40%">
//                40%
//                </div>

        } else {
            $("#itemNameError").html("No file chosen. By clicking the Choose Files button below, you can select the files you want to upload.");
        }

    }

    function move() {
        var elem = document.getElementById("progress-bar"); //progress-bar // myBar
        var width = 1;
        var id = setInterval(frame, 10);

        function frame() {
            if (width >= 100) {
                clearInterval(id);
                location.reload();
            } else {
                width++;
                elem.style.width = width + '%';
                elem.innerHTML = width * 1 + '%';
            }

        }
    }


</script>

<style>
    /*#myProgress {*/
    /*width: 90%;*/
    /*}*/

    #myProgress {
        width: 90%;
        background-color: #ddd;
    }

    #myBar {
        width: 10%;
        height: 30px;
        background-color: #4CAF50;
        text-align: center;
        line-height: 30px;
        color: white;
    }


</style>

<section class="mainSection">

    <% if (serverBlobs === null) { %>
    Nothing to see here. <a href="./">Click to create new container</a>.
    <% } else { %>
    <h1 class="pageTitle">Upload file</h1>
    <!--<div id="myProgress"> </div>-->

    <div id="myProgress">
        <!--<div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width:40%">-->
        <!--40%-->
        <!--</div>-->

    </div>
    <br>

    <form id="upload" action="/uploadhandler" method="post" enctype="multipart/form-data">
        <fieldset>
            <legend>Upload</legend>
            <ol>
                <li>
                    <span id="itemNameError" class="error"></span>
                </li>
                <input class="form-control-file" type="file" id="files" name="uploadedFile" multiple="multiple" />

            </ol>
            <input type="button" class="submit btn-primary" value="Upload" title="Upload" onclick="javascript:submitForm()"/>
        </fieldset>
    </form>


    <br><br>
    <h1 class="pageTitle">Blobs Available</h1>
    <% if (serverBlobs.length > 0) { %>

    <ul>
        <% for (var i = 0; i < serverBlobs.length; i++) { %>
        <li class="blobItem">
            <%= serverBlobs[i].name %>


            <!-- button for delete -->
            <a class="fa fa-trash" aria-hidden="true" href="javascript:deleteBlob(<%= i %>)"></a>

            <!-- button for download -->
            <a class="fa fa-download" aria-hidden="true" href="/Download/<%= serverBlobs[i].name %>"></a>

            <!--button for preview-->
            <a class="fa fa-eye" aria-hidden="true"></a>

            <!--<div id="myModal" class="modal">-->
                <!--<span class="close">&times;</span>-->
                <!--<img class="modal-content" id="img-<%= serverBlobs[i].name %>">-->
                <!--<div id="caption"></div>-->
            <!--</div>-->



            <form id="deleteBlobForm<%= i %>" action="/Delete/<%= serverBlobs[i].name %>" method="post"></form>
            <div id="DeleteConfirmationDialog<%= i %>" class="jquery-dialog" title="Delete Blob">
                <span class="ui-icon ui-icon-alert ui-icon-float"></span>
                <p>Are you sure you want to delete <%= serverBlobs[i].name %>?</p>
            </div>
        </li>
        <% } %>
    </ul>
    <% } else { %>
    <p>Nothing to see here. <a href="#files">Click to upload.</a></p>
    <% } %>
    <% } %>

</section>